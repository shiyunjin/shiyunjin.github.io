<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="çŸ³è•´é‡‘,to@shiyunjin.cn"><title>åœ¨Koolshare Lede V3.2 ä¸Šæ¢å¤æ”¯æŒfullcone nat Â· ç©º</title><meta name="description" content="ä¸€ç›´ç”¨fw867å¤§ç¥åˆ¶ä½œçš„Koolshare ledeçš„ç³»ç»Ÿ, åœ¨4æœˆä¸­æ—¬å…¶å‡çº§åˆ°V3.2ç”¨äº† 5.15.33 ç‰ˆæœ¬å†…æ ¸ä¹‹å,å°†ä¹‹å‰ä½¿ç”¨çš„iptablesé˜²ç«å¢™æ›¿æ¢æˆäº†å…¨æ–°çš„ nftables é˜²ç«å¢™,å¯¼è‡´ä¹‹å‰ iptables-mod-fullconenat å’Œ kmod-ipt-fullcone"><meta name="keywords" content="çŸ³è•´é‡‘,shiyunjin,blog"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/favicon.ico?" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><link rel="stylesheet" href="/highlight/styles/monokai-sublime.min.css"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106563546-3"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
(function (){
  gtag('js', new Date());

  gtag('config', 'UA-106563546-3');
})();

</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="sidebar"><div class="logo-title"><div class="title"><img src="https://q3.qlogo.cn/g?b=qq&amp;nk=673988474&amp;s=5" style="width:127px;border-radius: 300px;margin: 10px;"><h3 title=""><a href="/">ç©º</a></h3><div class="description"><p>ä¸å› ä½•äº‹å»åˆ¶ä½œ åªå› å…´è¶£è€Œåˆ›é€ </p></div></div></div><ul class="social-links"><li><a href="https://x.com/shi_yun_jin" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li><li><a href="http://weibo.com/673988474" target="_blank"><i class="fa fa-weibo"></i></a></li><li><a href="http://facebook.com/shiyunjin.cn" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="http://github.com/shiyunjin" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="/de6c5d8e.txt" target="_blank"><i class="fa fa-certificate"></i></a></li></ul><div class="footer"><span>Theme by </span><a href="https://www.caicai.me" target="_blank"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole" target="_blank"> Ben</a><div class="by_farbox"><span>Proudly published with </span><a href="https://hexo.io" target="_blank">Hexo</a><span>&#65281;</span></div></div></div><div class="main"><div class="page-top"><div class="nav"><li><a href="/">é¦–é¡µ</a></li><li><a href="/about">å…³äº</a></li><li><a href="/archives">å½’æ¡£</a></li><li><a href="/links">å‹é“¾</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><a class="avatar" href="https://t.me/s/shiyunjin" target="_blank" title="è®¢é˜…æˆ‘çš„ç”µæŠ¥é¢‘é“"><img src="/images/tg.svg"></a></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post"><div class="post-title"><h3><a>åœ¨Koolshare Lede V3.2 ä¸Šæ¢å¤æ”¯æŒfullcone nat</a></h3></div><div class="post-content"><p>ä¸€ç›´ç”¨fw867å¤§ç¥åˆ¶ä½œçš„Koolshare ledeçš„ç³»ç»Ÿ, åœ¨4æœˆä¸­æ—¬å…¶å‡çº§åˆ°V3.2ç”¨äº† <code>5.15.33</code> ç‰ˆæœ¬å†…æ ¸ä¹‹å,å°†ä¹‹å‰ä½¿ç”¨çš„<code>iptables</code>é˜²ç«å¢™æ›¿æ¢æˆäº†å…¨æ–°çš„ <code>nftables</code> é˜²ç«å¢™,å¯¼è‡´ä¹‹å‰ <code>iptables-mod-fullconenat</code> å’Œ <code>kmod-ipt-fullconenat</code> å®ç°çš„ fullcone å¤±æ•ˆ. æœ€è¿‘ç»è¿‡äº†3ä¸ªæ™šä¸Šçš„ç¼–è¯‘è°ƒè¯•ç»ˆäºåœ¨å…¶ä¸Šé¢å®ç°äº† fullcone.</p>
<h3 id="äº¤æµç¾¤"><a href="#äº¤æµç¾¤" class="headerlink" title="äº¤æµç¾¤"></a>äº¤æµç¾¤</h3><p>å¦‚æœå®‰è£…è¿‡ç¨‹å‡ºç°é—®é¢˜æˆ–æŠ€æœ¯äº¤æµå¯ä»¥åŠ å…¥</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://t.me/+Hi1zwBsT-083MTJl">Telegramäº¤æµç¾¤</a></li>
</ul>
<h1 id="å›ºä»¶ç‰ˆæœ¬"><a href="#å›ºä»¶ç‰ˆæœ¬" class="headerlink" title="å›ºä»¶ç‰ˆæœ¬"></a>å›ºä»¶ç‰ˆæœ¬</h1><p>è¦æ±‚å¿…é¡»ç‰ˆæœ¬å®Œå…¨ä¸€è‡´,å¦åˆ™æ›¿æ¢è¡¥ä¸å¯èƒ½ä¼šå‡ºç°é¢„æ–™ä¹‹å¤–çš„é—®é¢˜.</p>
<ul>
<li>å›ºä»¶ç‰ˆæœ¬: <code>Openwrt Koolshare Router V3.2 r19470-2f7d60f0e5</code></li>
<li>å†…æ ¸ç‰ˆæœ¬: <code>5.15.33</code></li>
</ul>
<h1 id="ä¸‹è½½æ–‡ä»¶"><a href="#ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ–‡ä»¶"></a>ä¸‹è½½æ–‡ä»¶</h1><p>å…ˆä¸‹è½½æˆ‘ç¼–è¯‘å¥½çš„éœ€è¦çš„æ–‡ä»¶<br>  Githubæº:</p>
<ul>
<li>ä»“åº“åœ°å€: <a target="_blank" rel="noopener" href="https://github.com/shiyunjin/koolshare-lede-fullcone/tree/V3.2-r19470-2f7d60f0e5">https://github.com/shiyunjin/koolshare-lede-fullcone/tree/V3.2-r19470-2f7d60f0e5</a></li>
<li>ç›´æ¥ä¸‹è½½: <a target="_blank" rel="noopener" href="https://github.com/shiyunjin/koolshare-lede-fullcone/archive/refs/heads/V3.2-r19470-2f7d60f0e5.zip">ç‚¹å‡»ä¸‹è½½</a></li>
</ul>
<h1 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h1><p><font color='red'><strong>Tips: ä¸è¦åœ¨ç½‘é¡µ<code>è½¯ä»¶åŒ…</code>é¡µé¢ä¸­é€šè¿‡<code>ä¸Šä¼ è½¯ä»¶åŒ…</code>è¿›è¡Œå®‰è£…, å› ä¸ºç‰ˆæœ¬æ˜¯ä¸€æ ·çš„ä¼šå¯¼è‡´è·³è¿‡å®‰è£…</strong></font></p>
<ol>
<li>å°†<code>ipk</code>æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°<code>/tmp</code>ç›®å½•ä¸‹,è¿è¡Œ</li>
</ol>
<pre><code class="bash"> cd /tmp/ipk
 opkg install kmod-nft-fullcone_5.15.33-1_x86_64.ipk --force-reinstall
 opkg install libnftnl11_1.2.1-10_x86_64.ipk --force-reinstall
 opkg install nftables-json_1.0.2-1_x86_64.ipk --force-reinstall
</code></pre>
<ol start="2">
<li>å°† <code>usr</code> æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶,æŒ‰ç…§ç›®å½•å±‚çº§è¿›è¡Œè¦†ç›–åˆ° <code>/usr</code> ç›®å½•ä¸‹</li>
</ol>
<ul>
<li><code>/usr/share/firewall4/templates/ruleset.uc</code> (è¦†ç›–)</li>
<li><code>/usr/share/firewall4/templates/zone-fullcone.uc</code> (æ–°æ–‡ä»¶)</li>
<li><code>/usr/share/ucode/fw4.uc</code> (è¦†ç›–)</li>
</ul>
<ol start="3">
<li>åœ¨ç½‘é¡µç«¯ <code>ç½‘ç»œ -&gt; é˜²ç«å¢™</code> å¼€å¯ <code>wan</code> åŒºåŸŸçš„ <code>fullcone</code> é€‰é¡¹, ä¿å­˜å¹¶åº”ç”¨<br>   <img src="/2022/06/21/koolshare-lede-v3-2-r19470-2f7d60f0e5-fullcone/20220621184035.png" alt="fullconeé€‰é¡¹"></li>
<li>æ‰§è¡Œå‘½ä»¤</li>
</ol>
<pre><code class="bash">root@LEDE:~# fw4 restart
Section @zone[1] (wan) fullcone enabled for zone &#39;wan&#39; #ä½ åº”è¯¥ä¼šçœ‹è§è¿™å¥è¯
</code></pre>
<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p><font color='red'><strong>Tips: è¿™ä¸ªè½¯ä»¶å¾ˆè€,å¾ˆå¸¸ç”¨,ä½†æ˜¯è¦æ³¨æ„,ä½¿ç”¨è¿™ä¸ªè½¯ä»¶åœ¨Windowsä¸Šéœ€è¦æŠŠè¿™ä¸ªè½¯ä»¶æ·»åŠ åˆ°é˜²ç«å¢™å…è®¸çš„åº”ç”¨. å¦‚æœä¸ä¼šæ·»åŠ ,è¯·ç›´æ¥å…³é—­Windowsé˜²ç«å¢™å¦åˆ™ä¼šæŠ¥<code>Restricted Port Cone</code></strong></font></p>
<ul>
<li>Natç±»å‹æ£€æµ‹</li>
</ul>
<p>   <img src="/2022/06/21/koolshare-lede-v3-2-r19470-2f7d60f0e5-fullcone/20220621184425.png" alt="Natç±»å‹æ£€æµ‹"></p>
<ul>
<li>NatTypeTester: <a target="_blank" rel="noopener" href="https://github.com/HMBSbige/NatTypeTester">https://github.com/HMBSbige/NatTypeTester</a></li>
</ul>
<p>   <img src="/2022/06/21/koolshare-lede-v3-2-r19470-2f7d60f0e5-fullcone/20220621184450.png" alt="NatTypeTester"></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-plus"></i><span class="date">2022-06-21 18:19:32</span><i class="fa fa-comments"></i><a href="/2022/06/21/koolshare-lede-v3-2-r19470-2f7d60f0e5-fullcone/#comments">è¯„è®º</a><i class="fa fa-tag"></i><a class="tag" href="/tags/koolshare/" title="koolshare">koolshare </a><a class="tag" href="/tags/lede/" title="lede">lede </a><a class="tag" href="/tags/fullcone/" title="fullcone">fullcone </a><a class="tag" href="/tags/openwrt/" title="openwrt">openwrt </a><a class="tag" href="/tags/nftables/" title="nftables">nftables </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://blog.shiyunjin.com/2022/06/21/koolshare-lede-v3-2-r19470-2f7d60f0e5-fullcone/,ç©º,åœ¨Koolshare Lede V3.2 ä¸Šæ¢å¤æ”¯æŒfullcone nat,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2022/06/22/peplacing-gitment-with-beaudar-on-hexo/" title="åœ¨ Hexo ä¸Šç”¨ Beaudar æ›¿æ¢ Gitment">ä¸Šä¸€ç¯‡</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2022/06/10/freepbx-volume-low/" title="è§£å†³ FreePBX æ¥æ‰“ç”µè¯å£°éŸ³å¤ªå°çš„é—®é¢˜">ä¸‹ä¸€ç¯‡</a></li></ul></div><style>.beaudar {
    margin: 0 30px;
    padding-bottom: 100px;
}
@media screen and (max-width: 1350px) {
    .beaudar {
        margin: 0 0 !important;
    }
}</style><script src="https://comment.shiyunjin.com/client.js" repo="shiyunjin/shiyunjin.github.io" issue-term="pathname" label="ğŸ’¬comment" theme="github-light" loading="false" input-position="top" crossorigin="anonymous" async></script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/highlight/highlight.min.js"></script><script>(function() {
  hljs.highlightAll();
})();</script></body></html>